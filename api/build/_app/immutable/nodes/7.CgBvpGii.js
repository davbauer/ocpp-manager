import"../chunks/disclose-version.Bg9kRutz.js";import"../chunks/legacy.K_zCUCQM.js";import{t as p,e as Ee,k as e,o as r,r as t,f as Pe,n as Ae,q as n,a3 as I}from"../chunks/runtime.ehUlzqf7.js";import{a as m,n as Re,d as De,s as d,t as w,c as qe}from"../chunks/render.CTvaeiJJ.js";import{i as B}from"../chunks/if.DhglbZ1u.js";import{e as Le,i as He}from"../chunks/each.xjQWOxjV.js";import{i as bt}from"../chunks/lifecycle.BkkXAv86.js";import{b as je,s as ze,a as k}from"../chunks/props.BJYttQBT.js";import{B as pt}from"../chunks/BasePage.BtoTIJcp.js";import{m as _t,n as ft,o as xt,p as yt,q as wt,d as Ct,t as kt}from"../chunks/queryClient.D14jiU7u.js";import{s as Te,t as Ne,b as Ue}from"../chunks/class.DcSGHe10.js";import{b as Mt}from"../chunks/this.F4vZ-ts8.js";import{d as Fe,z as L,t as y}from"../chunks/toast.CGwG1ZJt.js";import{f as St}from"../chunks/formatDistanceToNow.Cbs4euKL.js";import{S as Vt}from"../chunks/Scrollable.DcwQ1d9i.js";var Nt=Re('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M18 7l-1 1"></path><path d="M14 11h1a2 2 0 0 1 2 2v3a1.5 1.5 0 0 0 3 0v-7l-3 -3"></path><path d="M4 20v-14a2 2 0 0 1 2 -2h6a2 2 0 0 1 2 2v14"></path><path d="M9 11.5l-1.5 2.5h3l-1.5 2.5"></path><path d="M3 20l12 0"></path><path d="M4 8l10 0"></path></svg>');function Ut(u,a){let i=je(a,"class",3,"");var l=Nt();p(()=>Te(l,`icon icon-tabler icons-tabler-outline icon-tabler-charging-pile ${(i()||"")??""}`)),m(u,l)}var Et=Re('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M9.785 6l8.215 8.215l-2.054 2.054a5.81 5.81 0 1 1 -8.215 -8.215l2.054 -2.054z"></path><path d="M4 20l3.5 -3.5"></path><path d="M15 4l-3.5 3.5"></path><path d="M20 9l-3.5 3.5"></path></svg>');function Pt(u,a){let i=je(a,"class",3,"");var l=Et();p(()=>Te(l,`icon icon-tabler icons-tabler-outline icon-tabler-plug ${(i()||"")??""}`)),m(u,l)}const At=(u,a,i,l,_,H)=>{Fe.open({header:"Edit Charger",fields:[{label:"Friendly Name",name:"friendlyName",type:"text",defaultValue:a.charger.friendlyName||"",validation:L.string().min(1,{message:"Please enter a friendly name."})},{label:"Shortcode",name:"shortcode",type:"text",defaultValue:a.charger.shortcode||"",validation:L.string().regex(/^[a-z0-9-]+$/,{message:"Only lowercase letters, numbers, and dashes are allowed (no spaces or other characters)."}).min(5,{message:"Minimum length is 5 characters."}).max(30,{message:"Maximum length is 30 characters."})},{label:"Status",name:"status",type:"dropdown",options:[{label:"Pending",value:"Pending"},{label:"Accepted",value:"Accepted"},{label:"Rejected",value:"Rejected"}],defaultValue:a.charger.status||"Pending",validation:L.enum(["Pending","Accepted","Rejected"])}],actions:[{label:"Save",key:"save",class:"btn-primary",buttonType:"submit",callback:({fieldValues:c,close:N})=>{i().mutate({id:a.charger.id.toString(),friendlyName:c.friendlyName,status:c.status,shortcode:c.shortcode},{onError:()=>{y({message:"Error saving charger",type:"error"})},onSuccess:()=>{y({message:"Charger saved",type:"success"}),N()}})}},{label:"Cancel",key:"cancel",class:"btn-outline",callback:({close:c})=>{c()}},{label:"Delete",key:"delete",class:"btn-error btn-outline",buttonType:"button",callback:({close:c})=>{_().mutate({id:a.charger.id.toString()},{onError:()=>{y({message:"Error deleting charger",type:"error"})},onSuccess:()=>{y({message:"Charger deleted",type:"success"}),c()}}),c()}}]})};var Rt=(u,a)=>a("Soft"),Dt=(u,a)=>a("Hard"),qt=w('<div class="text-sm"><p><b>Current Load:</b> </p> <p><b>Power:</b> </p> <p><b>Temperature:</b> </p> <p><b>Frequency:</b> </p></div>'),Lt=w('<p class="text-sm">Telemetry data unavailable</p>'),Ht=w('<p class="text-error mt-1 text-sm"> </p>'),jt=(u,a,i,l)=>a().mutate({id:n(l).id.toString()}),zt=w('<div class="bg-base-300 flex w-full items-center justify-between rounded-lg p-4 shadow-md"><div class="flex items-center gap-4"><!> <div class="flex flex-col text-left"><span class="font-bold"> </span> <!> <!></div> <div class="w-16"></div> <button class="btn btn-ghost btn-sm">Unlock</button></div> <div class="flex items-center gap-4"><p class="text-sm font-medium"> </p> <div></div></div></div>'),Tt=w('<div class="bg-base-200 container mx-auto rounded-lg px-4 py-6 shadow-md"><div class="mb-6 flex items-center justify-between"><div class="flex items-center gap-4"><!> <div><h2 class="text-2xl font-semibold"> </h2> <p class="text-sm text-gray-500"> </p></div></div> <div class="flex gap-x-2"><div><button class="btn btn-ghost btn-sm">Reset</button> <dialog class="modal"><div class="modal-box"><form method="dialog"><button class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2">✕</button></form> <h3 class="mb-10 text-lg font-bold">Reset Charger</h3> <div class="flex gap-x-2"><button class="btn btn-warning btn-sm">Soft Reset</button> <button class="btn btn-error btn-sm">Hard Reset</button></div></div></dialog></div> <button class="btn btn-ghost btn-sm">Edit</button></div></div> <div class="mb-6"><span class="badge badge-lg badge-outline p-3"> </span></div> <table class="bg-base-300 table w-full overflow-hidden rounded-lg"><tbody><tr><td class="w-60 font-medium">Connectivity</td><td><span> </span></td></tr><tr><td class="w-60 font-medium">Firmware</td><td> </td></tr><tr><td class="w-60 font-medium">Model</td><td> </td></tr><tr><td class="w-60 font-medium">Last Heartbeat</td><td> </td></tr><tr><td class="w-60 font-medium">Shortcode</td><td> </td></tr></tbody></table> <div class="mt-6"><h3 class="mb-4 text-xl font-bold">Connectors</h3> <div class="space-y-4"><!></div></div></div>');function Ft(u,a){Ee(a,!0);const i=ze(),l=()=>k(M,"$mutationChargerUpdate",i),_=()=>k(S,"$mutationChargerDelete",i),H=()=>k($,"$mutationChargerReset",i),c=()=>k(le,"$queryConnectors",i),N=()=>k(j,"$mutationConnectorUnlock",i),le=_t(a.charger.id.toString(),1e4),M=ft(),S=xt(),$=yt(),j=wt(),O=v=>({Available:"bg-success",Preparing:"bg-info",Charging:"bg-primary",SuspendedEVSE:"bg-warning",SuspendedEV:"bg-warning",Finishing:"bg-info",Reserved:"bg-secondary",Unavailable:"bg-base-300",Faulted:"bg-error"})[v]||"bg-base-300";let U;const V=v=>{H().mutate({id:a.charger.id,type:v},{onError:()=>{y({message:"Error resetting charger",type:"error"})},onSuccess:()=>{y({message:"Charger reset",type:"success"}),U.close()}})};function E(v,C){for(const D of v){const x=D.sampledValue.find(s=>s.phase===C&&s.measurand==="Current.Import");if(x)return`${x.value} ${x.unit??""}`.trim()}return"N/A"}function P(v,C){for(const D of v){const x=D.sampledValue.find(s=>s.measurand===C&&!s.phase);if(x)return x.value}return"N/A"}var A=Tt(),h=e(A),f=e(h),z=e(f);Ut(z,{class:"text-primary h-10 w-10"});var T=r(z,2),R=e(T),Ie=e(R,!0);t(R);var de=r(R,2),Be=e(de,!0);t(de),t(T),t(f);var ce=r(f,2),Q=e(ce),ve=e(Q);ve.__click=()=>U.showModal();var W=r(ve,2),ue=e(W),ge=r(e(ue),4),me=e(ge);me.__click=[Rt,V];var $e=r(me,2);$e.__click=[Dt,V],t(ge),t(ue),t(W),Mt(W,v=>U=v,()=>U),t(Q);var Oe=r(Q,2);Oe.__click=[At,a,l,M,_,S],t(ce),t(h);var G=r(h,2),F=e(G),Qe=e(F,!0);t(F),t(G);var J=r(G,2),he=e(J),K=e(he),be=r(e(K)),X=e(be),We=e(X,!0);t(X),t(be),t(K);var Y=r(K),pe=r(e(Y)),Ge=e(pe,!0);t(pe),t(Y);var Z=r(Y),_e=r(e(Z)),Je=e(_e,!0);t(_e),t(Z);var ee=r(Z),fe=r(e(ee)),Ke=e(fe,!0);p(()=>d(Ke,a.charger.lastHeartbeat?St(new Date(a.charger.lastHeartbeat),{addSuffix:!0}):"N/A")),t(fe),t(ee);var xe=r(ee),ye=r(e(xe)),Xe=e(ye,!0);t(ye),t(xe),t(he),t(J);var we=r(J,2),Ce=r(e(we),2),Ye=e(Ce);{var Ze=v=>{var C=qe(),D=Ae(C);Le(D,1,()=>c().data,He,(x,s)=>{var te=zt(),ae=e(te),ke=e(ae);Pt(ke,{class:"h-6 w-6 text-current"});var re=r(ke,2),se=e(re),et=e(se);t(se);var Me=r(se,2);{var tt=b=>{var g=qt(),q=e(g);const dt=I(()=>{var o;return E((o=n(s).telemetry)==null?void 0:o.meterValue.raw,"L1")??""}),ct=I(()=>{var o;return E((o=n(s).telemetry)==null?void 0:o.meterValue.raw,"L2")??""}),vt=I(()=>{var o;return E((o=n(s).telemetry)==null?void 0:o.meterValue.raw,"L3")??""});var ut=r(e(q));p(()=>d(ut,` L1: ${n(dt)}, L2: ${n(ct)}, L3: ${n(vt)}`)),t(q);var oe=r(q,2),gt=r(e(oe));p(()=>{var o;return d(gt,` ${P((o=n(s).telemetry)==null?void 0:o.meterValue.raw,"Power.Active.Import")??""}W`)}),t(oe);var ie=r(oe,2),mt=r(e(ie));p(()=>{var o;return d(mt,` ${P((o=n(s).telemetry)==null?void 0:o.meterValue.raw,"Temperature")??""}°C`)}),t(ie);var Ve=r(ie,2),ht=r(e(Ve));p(()=>{var o;return d(ht,` ${P((o=n(s).telemetry)==null?void 0:o.meterValue.raw,"Frequency")??""} Hz`)}),t(Ve),t(g),m(b,g)},at=b=>{var g=Lt();m(b,g)};B(Me,b=>{var g;(g=n(s).telemetry)!=null&&g.meterValue.raw?b(tt):b(at,!1)})}var rt=r(Me,2);{var st=b=>{var g=Ht(),q=e(g);t(g),p(()=>d(q,`Error: ${n(s).errorCode??""}`)),m(b,g)};B(rt,b=>{n(s).errorCode&&b(st)})}t(re);var nt=r(re,4);nt.__click=[jt,N,j,s],t(ae);var Se=r(ae,2),ne=e(Se),ot=e(ne,!0);t(ne);var it=r(ne,2);const lt=I(()=>`h-3 w-20 rounded-full ${O(n(s).status)}`);t(Se),t(te),p(()=>{d(et,`Connector ${n(s).connectorId??""}`),d(ot,n(s).status),Ue(it,n(lt))}),m(x,te)}),m(v,C)};B(Ye,v=>{c().data&&v(Ze)})}t(Ce),t(we),t(A),p(()=>{d(Ie,a.charger.friendlyName||"Unknown"),d(Be,a.charger.vendor||"Unknown Vendor"),Ne(F,"badge-warning",a.charger.status==="Pending"),Ne(F,"badge-success",a.charger.status==="Accepted"),d(Qe,a.charger.status||"Unknown"),Ue(X,`badge badge-outline ${a.charger.connectivity==="Online"?"badge-success":"badge-warning"} p-3 text-white`),d(We,a.charger.connectivity||"Unknown"),d(Ge,a.charger.firmwareVersion||"N/A"),d(Je,a.charger.model||"N/A"),d(Xe,a.charger.shortcode||"N/A")}),m(u,A),Pe()}De(["click"]);const It=(u,a,i)=>{Fe.open({header:"Add Charger",fields:[{label:"Label",name:"label",type:"text",defaultValue:"",validation:L.string().min(1)},{label:"Shortcode",name:"shortcode",type:"text",defaultValue:"your-shortcode",validation:L.string().regex(/^[a-z0-9-]+$/,{message:"Only lowercase letters, numbers, and dashes are allowed (no spaces or other characters)."}).min(5,{message:"Minimum length is 5 characters."}).max(30,{message:"Maximum length is 30 characters."})}],actions:[{label:"Create",key:"create",class:"btn-primary",buttonType:"submit",callback:({fieldValues:l,close:_})=>{a().mutate({friendlyName:l.label,shortcode:l.shortcode},{onError:()=>{y({message:"Error creating charger",type:"error"})},onSuccess:()=>{y({message:"Charger created",type:"success"}),_()}})}}]})};var Bt=w('<div class="bg-base-200 rounded-lg p-8 text-center"><p class="text-base-content">Loading chargers...</p></div>'),$t=w('<div class="space-y-6"><!></div>'),Ot=w('<div class="container mx-auto px-4"><div class="mb-6 flex items-center justify-between"><h1 class="text-2xl font-bold">Chargers</h1> <button class="btn btn-primary">Add Charger</button></div> <!></div>');function ia(u,a){Ee(a,!1);const i=ze(),l=()=>k(c,"$mutationChargerCreate",i),_=()=>k(H,"$queryChargers",i),H=Ct(1e4),c=kt();bt(),pt(u,{title:"Monitoring",children:(N,le)=>{var M=Ot(),S=e(M),$=r(e(S),2);$.__click=[It,l,c],t(S);var j=r(S,2);Vt(j,{class:"p-4",maxHeight:"80svh",children:(O,U)=>{var V=$t(),E=e(V);{var P=h=>{var f=qe(),z=Ae(f);Le(z,1,()=>_().data,He,(T,R)=>{Ft(T,{get charger(){return n(R)}})}),m(h,f)},A=h=>{var f=Bt();m(h,f)};B(E,h=>{_().data?h(P):h(A,!1)})}t(V),m(O,V)},$$slots:{default:!0}}),t(M),m(N,M)},$$slots:{default:!0}}),Pe()}De(["click"]);export{ia as component};
