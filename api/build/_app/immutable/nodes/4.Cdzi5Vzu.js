import"../chunks/disclose-version.Bg9kRutz.js";import"../chunks/legacy.D2MqI-vY.js";import{e as mt,f as pt,t as _,k as a,n as i,r as e,x as vt,q as s}from"../chunks/runtime.Bd4EnX-u.js";import{d as ht,a as b,t as x,c as bt,s as f}from"../chunks/render.qcllsTlz.js";import{i as ft}from"../chunks/if.dA70V0X5.js";import{e as yt,i as Ct}from"../chunks/each.CqG-kNtr.js";import{i as _t}from"../chunks/lifecycle.C1YRy3UF.js";import{s as xt,a as u}from"../chunks/props.D1o1xWrs.js";import{b as Dt,d as $t,e as zt,f as It,g as At,h as wt}from"../chunks/queryClient.BEUBuIH3.js";import{d as W,z as p,t as m}from"../chunks/toast.CH_ZFDER.js";import{B as Tt}from"../chunks/BasePage.BX5KYPMs.js";import{I as St}from"../chunks/IconLockPin.cZLxxuos.js";import{S as kt}from"../chunks/Scrollable.BrMQmy-M.js";import{f as O}from"../chunks/formatDistanceToNow.Cbs4euKL.js";const Et=(D,c,o,d,v,$,q)=>{W.open({header:"Add Charge Authorization",fields:[{label:"Charger ID",name:"chargerId",type:"dropdown",options:c().data?c().data.map(r=>({label:`${r.friendlyName} (${r.vendor})`,value:r.id.toString()})):[],validation:p.string().min(1)},{label:"Expiry Date",name:"expiryDate",type:"date",defaultValue:"",validation:p.string()},{label:"RFID Tag ID",name:"rfidTagId",type:"dropdown",options:d().data?d().data.map(r=>({label:`${r.friendlyName} (${r.rfidTag})`,value:r.id.toString()})):[],validation:p.string().min(1)}],actions:[{label:"Create",key:"create",class:"btn-primary",buttonType:"submit",callback:({fieldValues:r,close:y})=>{$().mutate({chargerId:parseInt(r.chargerId),expiryDate:r.expiryDate?new Date(r.expiryDate):null,rfidTagId:parseInt(r.rfidTagId)||null},{onError:()=>{m({message:"Error creating charge authorization",type:"error"})},onSuccess:()=>{m({message:"Charge authorization created",type:"success"}),y()}})}}]})};var qt=(D,c,o)=>c(s(o)),Nt=x('<div class="bg-base-200 rounded-lg p-6 shadow-md"><div class="flex items-center justify-between"><div class="flex items-center gap-4"><!> <div><h3 class="text-xl font-semibold"> </h3></div></div> <button class="btn btn-ghost btn-sm">Edit</button></div> <table class="bg-base-300 mt-4 table w-full overflow-hidden rounded-lg"><tbody><tr><td class="w-60 font-medium">RFID Tag</td><td> </td></tr><tr><td class="w-60 font-medium">Charging Station</td><td> </td></tr><tr><td class="w-60 font-medium">Expiry Date</td><td> </td></tr><tr><td class="w-60 font-medium">Created</td><td> </td></tr></tbody></table></div>'),Rt=x('<div class="bg-base-200 rounded-lg p-8 text-center"><p class="text-base-content">Loading Charge Authorizations...</p></div>'),Pt=x('<div class="space-y-6"><!></div>'),Ut=x('<div class="container mx-auto px-4"><div class="mb-6 flex items-center justify-between"><h1 class="text-2xl font-bold">Charge Authorizations</h1> <button class="btn btn-primary">Add Charge Authorization</button></div> <!></div>');function Vt(D,c){mt(c,!1);const o=xt(),d=()=>u(N,"$queryChargers",o),v=()=>u(R,"$queryRfidTags",o),$=()=>u(P,"$mutationChargeAuthorizationCreate",o),q=()=>u(Y,"$mutationChargeAuthorizationUpdate",o),r=()=>u(Z,"$mutationChargeAuthorizationDelete",o),y=()=>u(X,"$queryChargeAuthorizations",o),X=Dt(1e4),N=$t(1e4),R=zt(1e4),P=It(),Y=At(),Z=wt(),V=l=>{var z;W.open({header:"Edit Charge Authorization",fields:[{label:"Charger ID",name:"chargerId",type:"dropdown",defaultValue:l.chargerId.toString(),options:d().data?d().data.map(t=>({label:`${t.friendlyName} (${t.vendor})`,value:t.id.toString()})):[],validation:p.string().min(1)},{label:"Expiry Date",name:"expiryDate",type:"date",defaultValue:l.expiryDate||"",validation:p.string()},{label:"RFID Tag ID",name:"rfidTagId",type:"dropdown",defaultValue:((z=l.rfidTagId)==null?void 0:z.toString())||"",options:v().data?v().data.map(t=>({label:`${t.friendlyName} (${t.rfidTag})`,value:t.id.toString()})):[],validation:p.string().min(1)}],actions:[{label:"Save",key:"save",class:"btn-primary",buttonType:"submit",callback:({fieldValues:t,close:h})=>{q().mutate({id:l.id,chargerId:parseInt(t.chargerId),expiryDate:t.expiryDate?new Date(t.expiryDate):null,rfidTagId:parseInt(t.rfidTagId)||null},{onError:()=>{m({message:"Error saving charge authorization",type:"error"})},onSuccess:()=>{m({message:"Charge authorization saving",type:"success"}),h()}})}},{label:"Cancel",key:"cancel",class:"btn-outline",callback:({close:t})=>{t()}},{label:"Delete",key:"delete",class:"btn-error btn-outline",buttonType:"button",callback:({close:t})=>{r().mutate({id:l.id},{onError:()=>{m({message:"Error deleting charge authorization",type:"error"})},onSuccess:()=>{m({message:"Charge authorization deleted",type:"success"}),t()}})}}]})};_t(),Tt(D,{title:"Charge Authorizations",children:(l,z)=>{var t=Ut(),h=a(t),U=i(a(h),2);U.__click=[Et,d,N,v,R,$,P],e(h);var tt=i(h,2);kt(tt,{class:"p-4",maxHeight:"80svh",children:(at,Ft)=>{var I=Pt(),et=a(I);{var rt=g=>{var C=bt(),ot=vt(C);yt(ot,1,()=>y().data,Ct,(nt,n)=>{var A=Nt(),w=a(A),T=a(w),F=a(T);St(F,{class:"text-primary h-10 w-10"});var M=i(F,2),Q=a(M),st=a(Q);e(Q),e(M),e(T);var dt=i(T,2);dt.__click=[qt,V,n],e(w);var j=i(w,2),B=a(j),S=a(B),L=i(a(S)),lt=a(L);e(L),e(S);var k=i(S),H=i(a(k)),ct=a(H);e(H),e(k);var E=i(k),G=i(a(E)),gt=a(G,!0);_(()=>f(gt,s(n).expiryDate?O(new Date(s(n).expiryDate),{addSuffix:!0}):"N/A")),e(G),e(E);var J=i(E),K=i(a(J)),ut=a(K,!0);_(()=>f(ut,O(new Date(s(n).createdAt),{addSuffix:!0}))),e(K),e(J),e(B),e(j),e(A),_(()=>{f(st,`Charger ID: ${s(n).chargerId??""}`),f(lt,`${s(n).tag.friendlyName??""} (${s(n).tag.rfidTag??""})`),f(ct,`${s(n).charger.friendlyName??""} (${s(n).charger.vendor??""})`)}),b(nt,A)}),b(g,C)},it=g=>{var C=Rt();b(g,C)};ft(et,g=>{y().data?g(rt):g(it,!1)})}e(I),b(at,I)},$$slots:{default:!0}}),e(t),_(()=>U.disabled=d().isPending||v().isPending),b(l,t)},$$slots:{default:!0}}),pt()}ht(["click"]);export{Vt as component};
